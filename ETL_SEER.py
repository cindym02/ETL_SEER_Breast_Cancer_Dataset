# -*- coding: utf-8 -*-
"""CM_JUPYTERNOTEBOOK_2.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1n6VAUWkchfnInZcSjxTUvJmwLB1_h0us
"""

import pandas as pd
import csv
import numpy as np
import seaborn as sns
import plotly.express as px
import matplotlib.pyplot as plt

#csv1
url = 'https://raw.githubusercontent.com/cindym02/hants-506/main/SEER%20Breast%20Cancer%20Dataset%20%20(1).csv'
df = pd.read_csv(url)
df

#1.Potential DV/IV 
df.info()

for var in df.columns: 
    print(var)

"""Potential independent variables: Age, tumor size, size of regional node, estrogen status

Dependent Variables: Survival months, status (mortality)
"""

#2.Missing Data
df.isnull()

df.isna().sum()

# The only missing data values within this dataset lies under the "unnamed: 3" column. This variable will be dropped since all reported values are NaN.
df.drop(['Unnamed: 3'], axis=1, inplace=True)

df.dtypes

df

#3a.Transformation on tumor size
#Breast cancer tumors over 20 millimeters in size are generally classified as larger tumors.
#This classification guideline is based on Narod's cohort study referenced in the paper.
for idx, row in df.iterrows():
  if row['Tumor Size'] >= 20:
    df.loc[idx, 'Tumor Size_description'] = 'Large'
  else:
    df.loc[idx, 'Tumor Size_description'] = 'Small'
df[['Tumor Size', 'Tumor Size_description']]

#3b.Transformation on age and likelihood of onset of menopause (average menopause age is 51)
def rules(row):
  if row['Age'] >= 51:
    return 'Menopausal'
  elif row['Age'] < 51:
    return 'Premenopausal'
df['Menopausal_likelihood'] = df.apply(rules,1)
df[['Age', 'Menopausal_likelihood']]

#Transformation to group ages
def rules3(row):
  if row['Age'] <= 49:
    return '30-49'
  elif row['Age'] > 49: 
    return '50-69'
df['Age Groups'] = df.apply(rules3,1)
df['Age Groups']

#Display of all transformations
df[['Tumor Size', 'Tumor Size_description', 'Age', 'Menopausal_likelihood']]

#4&6.Central tendency & quartile ranges (.25, .50, .75)
df[['Age','Tumor Size', 'Survival Months']].describe()

df[['Age','Tumor Size', 'Regional Node Examined']].median()

df[['Age','Tumor Size', 'Regional Node Examined']].mode()

#5.Value counts of age
#The majority of participants with breast canceer are older than 40 years old.
df[['Age']].value_counts()

#Value count of patients with estrogen positive breast cancer
#Majority of participants have ER+ breast cancer.
df[['Estrogen Status']].value_counts()

#5.Value counts of age
# The majority of patients were alive until the follow-up cut-off date 
df[['Status']].value_counts()

#5.Value counts of tumor size
# The most common tumor size is 15 millimeters.
# The total amount of participants with large tumors exceeds those with smaller tumors.
df[['Tumor Size', 'Tumor Size_description']].value_counts()

#5.Value counts of regional nodes that have metastasized
df[['Regional Node Examined']].value_counts()

#When grouped by likelihood of onset of menopause, premenopausal women tend to have larger tumors.
df.groupby(['Menopausal_likelihood'])['Tumor Size'].describe()

#When grouped by age groups, older women tend to have more regional nodes that have metastasized.
df.groupby(['Age Groups'])['Reginol Node Positive'].describe()

#7.Create at least 2 visualizations that help the reader understand your dataset
#This is a box plot for age distribution
#The range of participant age is 30 to 69, with the majority falling under 46 to 61 years of age.
sns.boxplot(x=df['Age'])

#7. This is a box plot showing tumor size distribution.
#The median size of tumors is 25 millimeters. Most patients have tumors between 15 to 40 millimeters.
#There are many outliers beyond the normal range.
sns.boxplot(x=df['Tumor Size'])

#Histogram showing the frequency of cancer cell differentiation.
#Grading and differentiation codes of 1-4
plt.hist(df['Grade'], color='#593211')
plt.ylabel('Number of Participants')
plt.xlabel('Grade')
plt.title('Distribution of Participants According to Grade Differentiation')
plt.show()

#7.Line chart displaying the correlation between tumor size and survival months.
sns.lineplot(data=df, x="Tumor Size", y="Survival Months")

sns.scatterplot(data=df, x="Age", y="Reginol Node Positive")

#Joint plot displaying the correlation between age and survival months
with sns.axes_style():
    sns.jointplot(x="Age", y="Survival Months", data=df, kind='hex')

df.hist('Tumor Size',bins=8)

df.hist('Age',bins=8)

df.hist('Tumor Size',bins=8)

df.hist('Survival Months',bins=8)

#Interactive 3d scatter plot displaying correlations between age, tumor size and survival months.
fig = px.scatter_3d(df, x='Age', y='Tumor Size', z='Survival Months', color='Survival Months')
fig.show()